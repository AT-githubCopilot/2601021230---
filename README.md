# 视频关键帧提取与宫格合成工具

一款轻量级的视频关键帧提取与宫格合成工具，支持多种提取模式和宫格布局，帮助用户快速获取视频核心内容并合成美观的宫格图。

## 功能特点

### 核心功能
- **视频信息解析**：自动获取视频的时长、帧率、分辨率、总帧数等信息
- **多种提取模式**：
  - 均匀间隔模式：按指定数量均匀提取关键帧
  - 关键场景模式：基于画面变化程度自动识别关键帧
  - 时间点指定模式：用户指定具体时间点进行截取
  - 混合模式：结合均匀间隔和关键场景识别
- **灵活的宫格合成**：
  - 自动适配布局或手动选择模板
  - 支持自定义间距、边框、输出尺寸
  - 多种图片适配模式
  - 支持添加标题和水印
- **友好的GUI界面**：直观的操作流程，实时预览效果

## 环境要求

- **操作系统**：Windows 10及以上、macOS 12及以上
- **Python版本**：3.8及以上
- **依赖库**：
  - numpy
  - opencv-python
  - Pillow
  - ffmpeg-python
  - PyQt5

## 安装步骤

1. 确保已安装Python 3.8及以上版本
2. 克隆或下载项目到本地
3. 安装依赖库：
   ```bash
   pip install -r requirements.txt
   ```
4. 运行主程序：
   ```bash
   python main.py
   ```

## 使用方法

### 1. 导入视频
- 点击「导入视频」按钮选择MP4视频文件
- 或直接拖拽MP4文件到程序窗口

### 2. 提取关键帧
- 设置提取数量（≥2张）
- 选择图片格式（JPG/PNG）
- 设置图片质量（仅JPG有效）
- 选择保存路径
- 点击「提取关键帧」按钮

### 3. 合成宫格图
- 选择宫格布局（自动计算或手动模板）
- 设置图片间距和边框
- 点击「合成宫格图」按钮
- 查看合成结果并保存

## 项目结构

```
视频关键帧提取与宫格合成工具/
├── src/                  # 源代码目录
│   ├── video_processor.py    # 视频处理核心模块
│   ├── frame_extractor.py    # 关键帧提取模块
│   ├── grid_synthesizer.py   # 宫格合成模块
│   ├── gui/                  # GUI界面
│   │   └── main_window.py    # 主窗口
│   └── utils/                # 工具类
│       ├── config.py         # 配置管理
│       └── logger.py         # 日志管理
├── tests/                 # 测试用例
├── assets/                # 静态资源
├── requirements.txt       # 依赖列表
├── main.py                # 程序入口
└── README.md              # 说明文档
```

## 功能说明

### 视频导入与信息解析
- 支持MP4格式视频导入
- 解析视频的基本信息（文件名、大小、路径）
- 解析视频的播放信息（时长、帧率）
- 解析视频的画面信息（分辨率、总帧数）

### 关键帧提取

#### 均匀间隔模式
- 按均匀间隔提取关键帧，确保首尾帧必包含
- 适合快速预览视频完整内容脉络

#### 关键场景模式
- 基于画面像素变化程度自动识别关键帧
- 变化幅度超过阈值则判定为关键帧
- 适合提取视频中核心事件、场景切换画面

#### 时间点指定模式
- 用户手动输入多个时间点
- 精确提取对应时间点的画面
- 适合提取特定时刻画面

#### 混合模式
- 先按均匀间隔提取基础帧
- 再补充画面变化明显的关键帧
- 平衡预览完整性与关键场景突出需求

### 宫格合成
- 自动计算最优宫格布局
- 支持常用模板（2×2、3×3、4×4等）
- 支持自定义行数和列数
- 可设置图片间距、边框宽度和颜色
- 支持多种输出尺寸
- 支持中心裁剪或保持纵横比的图片适配模式

## 注意事项

- 仅支持MP4格式视频
- 处理4K视频时可能需要较长时间
- 建议将保存路径设置为SSD驱动器以提高性能
- 首次运行时会在用户目录下创建配置文件和日志目录

## 技术栈

- **主语言**：Python
- **视频处理**：FFmpeg + OpenCV
- **图像处理**：PIL/Pillow
- **GUI框架**：PyQt5

## 许可证

MIT License

## 更新日志

### v1.0.0
- 初始版本
- 支持均匀间隔模式关键帧提取
- 支持基础宫格合成
- 提供GUI界面

## 反馈与建议

如有任何问题或建议，欢迎提交Issue或联系作者。
