# 经验笔记日志

## 时间：2026-01-02 17:00

## 项目：视频关键帧提取与宫格合成工具

## 遇到的坑及解决方案汇总

### 1. PyQt5安装超时问题

**问题描述**：直接使用pip安装PyQt5时，由于包较大，经常遇到下载超时问题

**解决方案**：
- 使用国内镜像源加速安装
- 延长超时时间
- 命令：`py -m pip install PyQt5 -i https://pypi.tuna.tsinghua.edu.cn/simple --timeout 120`

**经验总结**：安装大体积包时，使用国内镜像源可以显著提高下载速度，避免超时问题

### 2. 视频信息获取失败

**问题描述**：GUI界面顶部显示"无法获取视频信息：'FrameExtractor' object has no attribute 'get_video_info'"

**原因**：代码中调用了不存在的方法，FrameExtractor类没有get_video_info方法，应该直接访问video_info属性

**解决方案**：
- 将`info = extractor.get_video_info()`改为`info = extractor.video_info`
- 文件：`src/gui/main_window.py:293`

**经验总结**：调用类方法前，需要确认该方法是否存在；属性访问和方法调用要区分清楚

### 3. 宫格图保存路径问题

**问题描述**：宫格图默认保存到了`指定目录/宫格图`子目录，而不是直接保存到指定目录

**原因**：代码中硬编码了"宫格图"子目录

**解决方案**：
- 移除了子目录创建，直接将宫格图保存到用户指定的目录
- 文件：`src/gui/main_window.py:431`

**经验总结**：保存路径应该尊重用户选择，避免硬编码路径

### 4. 双击Python文件被要求安装Python

**问题描述**：双击.py文件时，系统提示"Python未找到；运行无参数以从Microsoft Store安装"

**原因**：
- Python未添加到系统PATH
- Microsoft Store的Python应用执行别名干扰
- 文件关联错误

**解决方案**：
1. 禁用Microsoft Store的Python应用执行别名
   - 设置 → 应用执行别名 → 关闭所有Python相关开关
2. 确保Python添加到系统PATH
   - 检查环境变量中的Path是否包含Python路径
3. 手动设置文件关联
   - 右键.py文件 → 打开方式 → 选择正确的Python解释器

**经验总结**：Python安装时务必勾选"Add Python to PATH"选项，避免后续环境配置问题

### 5. IDE与系统Python环境不一致

**问题描述**：
- 直接点击main.py可以正常运行
- 在IDE中点击播放按钮报错：`ModuleNotFoundError: No module named 'PyQt5'`

**原因**：IDE使用了与系统不同的Python环境，PyQt5只安装在系统Python环境中

**解决方案**：
- 在IDE中切换Python解释器到系统Python环境
- 或在IDE使用的Python环境中重新安装依赖

**操作步骤**：
1. 点击IDE右下角的Python版本号
2. 选择正确的Python环境路径（如`D:\software\python\Python312\python.exe`）
3. 如列表中没有，选择"Enter interpreter path..."手动添加

**经验总结**：IDE的Python环境和系统环境可能不同，需要确保使用的是安装了所有依赖的环境

### 6. 编译文件清理

**问题描述**：项目中存在大量编译后的.pyc文件和__pycache__目录，占用空间且影响代码整洁

**解决方案**：删除所有__pycache__目录和.pyc文件

**命令**：
- `rm -rf src/__pycache__`
- `rm -rf src/gui/__pycache__`

**经验总结**：定期清理编译文件，保持项目整洁，减少不必要的文件

### 7. 虚拟环境管理

**问题描述**：虚拟环境占用大量空间，且可以通过requirements.txt重新创建

**解决方案**：删除虚拟环境目录，需要时重新创建

**命令**：`rm -rf venv`

**经验总结**：虚拟环境不需要纳入版本控制，删除后可以通过requirements.txt重新创建

## 开发建议

1. **代码规范**：
   - 避免硬编码路径和常量
   - 类方法和属性命名要清晰
   - 定期清理无用代码和临时文件

2. **环境配置**：
   - Python安装时务必勾选"Add Python to PATH"
   - 禁用Microsoft Store的Python应用执行别名
   - 保持IDE和系统Python环境一致

3. **依赖管理**：
   - 使用requirements.txt管理依赖
   - 安装大体积包时使用国内镜像源
   - 定期更新依赖版本

4. **错误处理**：
   - 添加适当的错误处理机制
   - 提供清晰的错误提示
   - 日志记录要详细

5. **测试习惯**：
   - 每次修改后测试功能是否正常
   - 测试不同场景和参数组合
   - 记录测试结果和遇到的问题

## 后续计划

1. 实现更多关键帧提取模式（关键场景模式、时间点指定模式、混合模式）
2. 完善宫格合成功能，支持更多个性化定制
3. 添加批量处理功能
4. 优化GUI界面，提升用户体验
5. 编写更详细的使用文档和API文档

## 备注

本日志记录了项目开发过程中遇到的问题和解决方案，后续遇到的问题将继续添加到本文件或创建新的日志文件。日志文件采用时间戳命名，方便追踪项目进展和问题解决过程。