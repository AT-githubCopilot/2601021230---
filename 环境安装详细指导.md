# 环境安装详细指导

## 一、安装Python环境

### 1. 下载Python

1. 打开浏览器，访问Python官方下载页面：https://www.python.org/downloads/
2. 点击页面中的「Download Python 3.x.x」按钮（x.x.x表示最新版本号）
3. 下载完成后，找到下载的安装包（通常在「下载」文件夹中）

### 2. 安装Python

1. 双击运行下载好的Python安装包
2. **非常重要**：勾选「Add Python 3.x to PATH」选项（这会让Python在命令行中可用）
3. 点击「Install Now」开始安装
4. 等待安装完成，点击「Close」关闭窗口

### 3. 验证Python安装成功

1. 按下键盘上的 `Win + R` 组合键，打开「运行」对话框
2. 输入 `cmd`，然后按「确定」打开命令提示符
3. 在命令提示符中输入以下命令：
   ```
   python --version
   ```
4. 按下回车键，如果看到类似 `Python 3.11.5` 的输出，说明Python安装成功
5. 再输入以下命令验证pip（Python包管理器）是否可用：
   ```
   pip --version
   ```
6. 按下回车键，如果看到类似 `pip 23.2.1 from ...` 的输出，说明pip安装成功

## 二、安装FFmpeg

### 1. 下载FFmpeg

1. 打开浏览器，访问FFmpeg官方下载页面：https://ffmpeg.org/download.html
2. 找到「Windows」部分，点击「Windows builds from gyan.dev」链接
3. 在新页面中，找到「ffmpeg-release-full.7z」下载链接（这是完整版本，包含所有功能）
4. 下载完成后，找到下载的7z压缩包

### 2. 解压FFmpeg

1. 右键点击下载的7z压缩包
2. 选择「解压到当前文件夹」（需要有7-Zip或WinRAR等解压软件）
3. 解压后会得到一个名为「ffmpeg-xxx-full_build」的文件夹

### 3. 配置FFmpeg环境变量

1. 右键点击「此电脑」，选择「属性」
2. 在左侧菜单中点击「高级系统设置」
3. 点击「环境变量」按钮
4. 在「系统变量」区域，找到并选中「Path」变量，然后点击「编辑」
5. 点击「新建」按钮，然后输入FFmpeg的bin文件夹路径
   - 例如：如果FFmpeg解压到了「D:\ffmpeg-2024-01-01-full_build」，那么路径应该是「D:\ffmpeg-2024-01-01-full_build\bin」
6. 点击「确定」保存所有设置

### 4. 验证FFmpeg安装成功

1. 打开一个新的命令提示符窗口
2. 输入以下命令：
   ```
   ffmpeg -version
   ```
3. 按下回车键，如果看到FFmpeg的版本信息，说明FFmpeg安装成功

## 三、安装工具依赖库

### 1. 打开命令提示符

1. 按下 `Win + R`，输入 `cmd`，按「确定」打开命令提示符
2. 使用 `cd` 命令进入工具所在的文件夹
   - 例如：如果工具在「d:\2512201334-traeprojects\2601021230-视频处理工具」，则输入：
     ```
     cd /d d:\2512201334-traeprojects\2601021230-视频处理工具
     ```
3. 按下回车键，确保当前目录正确

### 2. 安装依赖库

1. 在命令提示符中输入以下命令：
   ```
   pip install -r requirements.txt
   ```
2. 按下回车键，pip会自动安装所有需要的依赖库
3. 等待安装完成，不要关闭命令提示符窗口

### 3. 验证依赖库安装成功

1. 安装完成后，输入以下命令验证几个关键库：
   ```
   pip list | findstr numpy
   pip list | findstr opencv-python
   pip list | findstr Pillow
   pip list | findstr PyQt5
   ```
2. 如果每个命令都能看到对应的版本信息，说明依赖库安装成功

## 四、运行视频关键帧提取工具

### 1. 启动工具

1. 确保命令提示符仍在工具所在的文件夹中
2. 输入以下命令：
   ```
   python main.py
   ```
3. 按下回车键，等待工具启动

### 2. 使用工具

1. 工具启动后，会看到一个图形界面
2. 点击「导入视频」按钮，选择一个MP4视频文件
3. 设置提取参数（提取数量、图片格式等）
4. 点击「提取关键帧」按钮
5. 提取完成后，设置宫格参数
6. 点击「合成宫格图」按钮
7. 查看合成结果

## 五、常见问题及解决方案

### 1. 问题：命令提示符中输入python后提示「python不是内部或外部命令」

**解决方案**：
- 检查Python安装时是否勾选了「Add Python 3.x to PATH」选项
- 重新安装Python，确保勾选该选项
- 手动添加Python的安装路径到系统环境变量

### 2. 问题：输入ffmpeg -version后提示「ffmpeg不是内部或外部命令」

**解决方案**：
- 检查FFmpeg的bin文件夹路径是否正确添加到系统环境变量
- 确保使用的是新打开的命令提示符窗口
- 重新检查环境变量配置

### 3. 问题：pip install命令运行缓慢或失败

**解决方案**：
- 尝试使用国内镜像源加速安装：
  ```
  pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
  ```
- 检查网络连接是否正常

### 4. 问题：运行python main.py后提示缺少某个模块

**解决方案**：
- 确保所有依赖库都已正确安装
- 重新运行pip install -r requirements.txt命令
- 检查错误信息中提到的模块名，尝试单独安装：
  ```
  pip install 模块名
  ```

### 5. 问题：工具启动后无法导入视频

**解决方案**：
- 确保视频格式为MP4
- 检查视频文件是否损坏
- 检查FFmpeg是否正确安装

## 六、联系方式

如果在安装过程中遇到任何问题，或者工具运行时有异常，可以联系开发者寻求帮助。

祝您使用愉快！
